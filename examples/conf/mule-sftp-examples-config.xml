<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mule-configuration PUBLIC "-//SymphonySoft //DTD mule-configuration XML V1.0//EN"
"http://www.symphonysoft.com/dtds/mule/mule-configuration.dtd">
<mule-configuration id="SFTP_TEST" version="1.0">
	<description>Sftp testing.</description>
	<mule-environment-properties synchronous="true"/>
	<!-- SFTP-connector -->
	<connector name="sftpConnector"
		className="org.mule.providers.sftp.SftpConnector">
		<properties>
			<property name="outputPattern" value="${DATE}.dat"/>
			<property name="pollingFrequency" value="5000"/>
		</properties>
	</connector>
        <connector name="SystemStreamConnector"
                className="org.mule.providers.stream.SystemStreamConnector">
                <properties>
                    <property name="promptMessage"
                     value="=====SFTP Demo.  Enter file contents to be routed to SFTP service .=====" />
                    <property name="messageDelayTime" value="5000" />
                </properties>
        </connector>
	<transformers>
            <transformer name="InputStreamToByteArray" className="org.mule.providers.sftp.transformers.InputStreamToByteArray"/>
            <transformer name="ByteArrayToString" className="org.mule.transformers.simple.ByteArrayToString"/>
        </transformers>		
    	
	<model name="testSftp">
		
		<mule-descriptor name="sftpSend"
			implementation="org.mule.components.simple.BridgeComponent">
			<inbound-router>
				<endpoint address="stream://System.in"/>
			</inbound-router>
			<outbound-router>
				<router
					className="org.mule.routing.outbound.OutboundPassThroughRouter">
					<endpoint
						address="sftp://mule:test123@localhost/files/sftp-target"
						connector="sftpConnector"/>
				</router>
			</outbound-router>
			
		</mule-descriptor>
		<mule-descriptor name="sftpReceive"
			implementation="org.mule.components.simple.BridgeComponent">
			<inbound-router>
				<endpoint
					address="sftp://mule:test123@localhost/files/sftp-target" transformers="InputStreamToByteArray ByteArrayToString"/>
			</inbound-router>
			<outbound-router>
				<router
					className="org.mule.routing.outbound.OutboundPassThroughRouter">
					<endpoint address="stream://System.out"/>
				</router>
			</outbound-router>
			
		</mule-descriptor>
	</model>
	
</mule-configuration>


