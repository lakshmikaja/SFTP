<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mule-configuration PUBLIC "-//SymphonySoft //DTD mule-configuration XML V1.0//EN"
"http://www.symphonysoft.com/dtds/mule/mule-configuration.dtd">
<mule-configuration id="SFTP_TEST" version="1.0">
	<description>Sftp testing.</description>

	<mule-environment-properties synchronous="true" />

	
	<!-- SFTP-connector -->
	<connector name="sftpConnector"
		className="org.mule.providers.sftp.SftpConnector">
		<properties>
			<property name="pollingFrequency" value="500000"/>
			<property name="autoDelete" value="true"/>
		</properties>
	</connector>
	
    <connector name="vmQueue" className="org.mule.providers.vm.VMConnector">
		<properties>
			<property name="queueEvents" value="true"/>
		</properties>
	</connector>
	
	<transformers>
        <transformer name="InputStreamToByteArray" className="org.mule.providers.sftp.transformers.InputStreamToByteArray"/>
    </transformers>		
	<!-- MODEL -->
	<model name="testSftp">

		<!--
	<mule-descriptor name="sftpDownload"
		implementation="org.mule.providers.sftp.components.TestComponent">
		-->
	<mule-descriptor name="sftpUpload"
		implementation="org.mule.components.simple.BridgeComponent">	
		<inbound-router>
		        <!-- Note that OOM will result if file(s) downloaded are large since InputStreamToByteArray is used  -->
		        <!-- See LargeFileReceiveFunctionalTestCase for handling large files -->

				<endpoint address="sftp://mule:test123@localhost/files/sftp-source" 
					connector="sftpConnector" transformers="InputStreamToByteArray">
					<filter pattern="*.txt"
                            className="org.mule.providers.file.filters.FilenameWildcardFilter" />			
				</endpoint>
		</inbound-router>
		<outbound-router>
		     <router className="org.mule.routing.outbound.OutboundPassThroughRouter">
				<endpoint address="vm://test.download" connector="vmQueue"/>
		     </router>
		</outbound-router>
	</mule-descriptor>


	</model>
</mule-configuration>


